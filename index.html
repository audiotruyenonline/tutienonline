<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tu Luyá»‡n RPG Demo</title>
<style>
body {
  background: #0f1115;
  color: #eee;
  font-family: Arial;
  padding: 20px;
}
.card {
  background: #1a1d24;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 20px;
}
button {
  padding: 8px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
.progress {
  height: 10px;
  background: #333;
  border-radius: 10px;
  overflow: hidden;
}
.bar {
  height: 100%;
  background: #6c8cff;
}
.inventory-item {
  padding: 5px;
  margin: 4px 0;
  background: #252a35;
  border-radius: 6px;
}
</style>
</head>
<body>

<h1>âš” Tu Luyá»‡n RPG Demo</h1>

<div class="card">
  <h2>NhÃ¢n váº­t</h2>
  <div>Cáº¥p: <span id="level"></span></div>
  <div>EXP: <span id="exp"></span></div>
  <div class="progress"><div class="bar" id="expBar"></div></div>
  <div>Cáº£nh giá»›i: <span id="realm"></span></div>
  <div>Lá»±c chiáº¿n: <span id="power"></span></div>
  <div>Linh khÃ­: <span id="energy"></span> / 100</div>
  <button onclick="breakthrough()">ğŸ”¥ Äá»™t phÃ¡</button>
</div>

<div class="card">
  <h2>ğŸ“– Äá»c truyá»‡n</h2>
  <p>KÃ©o xuá»‘ng Ä‘á»c, má»—i 60 giÃ¢y sáº½ +10 EXP</p>
  <div id="readTimer">0 giÃ¢y</div>
</div>

<div class="card">
  <h2>âš” ÄÃ¡nh Boss</h2>
  <div>Boss Power: 150</div>
  <button onclick="fightBoss()">KhiÃªu chiáº¿n</button>
  <div id="fightResult"></div>
</div>

<div class="card">
  <h2>ğŸ’ Inventory</h2>
  <div id="inventory"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("gameData")) || {
  exp: 0,
  realm: 1,
  power: 10,
  energy: 50,
  maxEnergy: 100,
  lastEnergyUpdate: Date.now(),
  inventory: []
};

function save() {
  localStorage.setItem("gameData", JSON.stringify(data));
}

function expToLevel(exp) {
  return Math.floor(Math.sqrt(exp / 100));
}

function updateUI() {
  const level = expToLevel(data.exp);
  const nextReq = (level + 1) ** 2 * 100;
  const curReq = level ** 2 * 100;
  const pct = ((data.exp - curReq) / (nextReq - curReq)) * 100;

  document.getElementById("level").innerText = level;
  document.getElementById("exp").innerText = data.exp;
  document.getElementById("realm").innerText = data.realm;
  document.getElementById("power").innerText = data.power;
  document.getElementById("energy").innerText = data.energy;
  document.getElementById("expBar").style.width = pct + "%";

  const inv = document.getElementById("inventory");
  inv.innerHTML = "";
  data.inventory.forEach(item => {
    const div = document.createElement("div");
    div.className = "inventory-item";
    div.innerText = item.name + " (+" + item.power + ")";
    inv.appendChild(div);
  });
}

function regenEnergy() {
  const now = Date.now();
  const diff = now - data.lastEnergyUpdate;
  const ticks = Math.floor(diff / (5 * 60 * 1000));
  if (ticks > 0) {
    data.energy = Math.min(data.maxEnergy, data.energy + ticks);
    data.lastEnergyUpdate = now;
    save();
  }
}

function breakthrough() {
  const required = data.realm * 1000;
  if (data.exp >= required) {
    data.exp -= required;
    data.realm++;
    data.power += 100;
    alert("ğŸ”¥ Äá»™t phÃ¡ thÃ nh cÃ´ng!");
    save();
    updateUI();
  } else {
    alert("ChÆ°a Ä‘á»§ tu vi!");
  }
}

function fightBoss() {
  if (data.energy < 10) {
    alert("KhÃ´ng Ä‘á»§ linh khÃ­!");
    return;
  }

  data.energy -= 10;

  const winChance = data.power / (data.power + 150);
  if (Math.random() < winChance) {
    const item = generateItem();
    data.inventory.push(item);
    data.power += item.power;
    document.getElementById("fightResult").innerText =
      "ğŸ”¥ Tháº¯ng! Nháº­n " + item.name;
  } else {
    document.getElementById("fightResult").innerText = "ğŸ’€ Thua!";
  }

  save();
  updateUI();
}

function generateItem() {
  const roll = Math.random();
  if (roll > 0.8) return { name: "Epic Kiáº¿m", power: 50 };
  if (roll > 0.5) return { name: "Rare Kiáº¿m", power: 25 };
  return { name: "Common Kiáº¿m", power: 10 };
}

let readSeconds = 0;
setInterval(() => {
  readSeconds++;
  document.getElementById("readTimer").innerText = readSeconds + " giÃ¢y";

  if (readSeconds % 60 === 0) {
    data.exp += 10;
    save();
    updateUI();
  }
}, 1000);

regenEnergy();
updateUI();
</script>

</body>
</html>
